<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>SecureBank - Login</title>
    <link rel="stylesheet" href="styles.css" />
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üè¶</text></svg>">
</head>

<body class="auth-page">
    <div class="auth-container">
        <div class="logo">
            <span class="logo-icon">üè¶</span>
            <h1>SecureBank</h1>
            <p class="tagline">Your Trusted Banking Partner</p>
        </div>

        <div class="auth-box">
            <div class="tabs">
                <button class="tab active" onclick="switchTab('login')">Login</button>
                <button class="tab" onclick="switchTab('register')">Register</button>
            </div>

            <form id="loginForm" onsubmit="handleLogin(event)">
                <div class="form-group">
                    <label for="loginEmail">Email</label>
                    <input type="email" id="loginEmail" placeholder="Enter your email" required />
                </div>
                <div class="form-group">
                    <label for="loginPassword">Password</label>
                    <input type="password" id="loginPassword" placeholder="Enter your password" required />
                </div>
                <button type="submit" class="btn-primary">Login</button>
            </form>

            <form id="registerForm" class="hidden" onsubmit="handleRegister(event)">
                <div class="form-group">
                    <label for="registerName">Full Name</label>
                    <input type="text" id="registerName" placeholder="Enter your full name" required />
                </div>
                <div class="form-group">
                    <label for="registerEmail">Email</label>
                    <input type="email" id="registerEmail" placeholder="Enter your email" required />
                </div>
                <div class="form-group">
                    <label for="registerPassword">Password</label>
                    <input type="password" id="registerPassword" placeholder="Create a password" required minlength="6" />
                </div>
                <div class="form-group">
                    <label for="registerConfirm">Confirm Password</label>
                    <input type="password" id="registerConfirm" placeholder="Confirm your password" required />
                </div>
                <button type="submit" class="btn-primary">Create Account</button>
            </form>

            <div id="authMessage" class="message"></div>
        </div>

        <div class="admin-link">
            <a href="admin.html">Admin Login</a>
        </div>
    </div>

    <script>
        const USERS_KEY = "banking_users";
        const CURRENT_USER_KEY = "current_user";

        function getUsers() {
            const data = localStorage.getItem(USERS_KEY);
            return data ? JSON.parse(data) : [];
        }

        function saveUsers(users) {
            localStorage.setItem(USERS_KEY, JSON.stringify(users));
        }

        function switchTab(tab) {
            const tabs = document.querySelectorAll('.tab');
            tabs.forEach(t => t.classList.remove('active'));
            event.target.classList.add('active');

            if (tab === 'login') {
                document.getElementById('loginForm').classList.remove('hidden');
                document.getElementById('registerForm').classList.add('hidden');
            } else {
                document.getElementById('loginForm').classList.add('hidden');
                document.getElementById('registerForm').classList.remove('hidden');
            }
            document.getElementById('authMessage').textContent = '';
        }

        function showMessage(msg, isError = true) {
            const el = document.getElementById('authMessage');
            el.textContent = msg;
            el.className = 'message ' + (isError ? 'error' : 'success');
        }

        function handleLogin(e) {
            e.preventDefault();
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            const users = getUsers();
            const user = users.find(u => u.email === email && u.password === password);

            if (user) {
                localStorage.setItem(CURRENT_USER_KEY, JSON.stringify(user));
                window.location.href = 'dashboard.html';
            } else {
                showMessage('Invalid email or password.');
            }
        }

        function handleRegister(e) {
            e.preventDefault();
            const name = document.getElementById('registerName').value;
            const email = document.getElementById('registerEmail').value;
            const password = document.getElementById('registerPassword').value;
            const confirm = document.getElementById('registerConfirm').value;

            if (password !== confirm) {
                showMessage('Passwords do not match.');
                return;
            }

            const users = getUsers();
            if (users.find(u => u.email === email)) {
                showMessage('Email already registered.');
                return;
            }

            const newUser = {
                id: Date.now(),
                name,
                email,
                password,
                balance: 0,
                accounts: [
                    { type: 'Checking', balance: 0, accountNumber: generateAccountNumber() },
                    { type: 'Savings', balance: 0, accountNumber: generateAccountNumber() }
                ],
                createdAt: new Date().toISOString()
            };

            users.push(newUser);
            saveUsers(users);
            showMessage('Account created! Please login.', false);
            switchTab('login');
        }

        function generateAccountNumber() {
            return 'SB' + Math.floor(100000 + Math.random() * 900000);
        }

        // Check if already logged in
        window.onload = function() {
            const currentUser = localStorage.getItem(CURRENT_USER_KEY);
            if (currentUser) {
                window.location.href = 'dashboard.html';
            }
        };
    </script>
</body>

</html>
